# SIM-002 â€“ DNS Tunneling (T1071.004)

## ğŸ¯ Goal

Simulate DNS tunneling traffic to validate zeek-based DNS anomaly detection, Suricata DNS rules, and Splunk correlation for covert command-and-control channels.

This simulation validates the **LAB-SIM-002** entry in the detection validation matrix.

---

## ğŸ§© MITRE ATT&CK Mapping

- **Technique:** T1071.004 â€“ Application Layer Protocol: DNS
- **Tactic:** Command and Control (TA0011)

---

## ğŸ— Lab Components Used

- **Attacker:** Kali Linux (10.0.0.30)
- **Victim Host:** Windows 11 (10.0.0.50) *(optional DNS tunneling client)*
- **Network Sensor:** Security Onion (Zeek + Suricata)
- **SIEM:** Splunk Enterprise (Ubuntu â€“ 10.0.0.60)
- **Gateway:** pfSense (10.0.0.1)

---

## ğŸ“‚ Files in This Simulation

- `steps.md` â€“ Full DNS tunneling execution steps
- `logs.md` â€“ Symbolic Zeek + Suricata + Splunk events
- `queries.md` â€“ SPL detection logic
- `alert-config.md` â€“ Splunk alert configuration
- `screenshots/` â€“ Visual detection evidence

---

## âœ… Success Criteria

- Abnormally long or encoded DNS queries generated
- Zeek logs detect suspicious DNS behavior
- Suricata flags DNS anomalies (if enabled)
- Splunk correlates events
- Symbolic alert fires:
    LAB-SIM-002-DNS-TUNNEL

---

## âœ… Status

- âœ… DNS traffic generated and captured
- âœ… Packet-level visibility validated
- âœ… Security Onion sensor confirmed operational
- âŒ Suricata â†’ Elastic ingest blocked due to authentication failure
- âœ… SIEM outage documented
- âœ… Fallback detection successfully executed
- âœ… Screenshots captured

